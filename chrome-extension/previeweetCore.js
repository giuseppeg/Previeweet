(function(a){var b={main:function(b){var c=a('.tweet:not(".previeweet")');var d=c.map(function(b,c){return a(c).attr("data-tweet-id")}).get();var e=b.streams.current.items;e=a.map(e,function(a,b){var c=a.entities;if(c){var e=c.media;if(!!e&&e.length&&e[0].type=="photo"&&d.indexOf(a.id)!=-1)return{id:a.id,url:e[0].media_url_https+":thumb"}}});var f=c.find('a[data-expanded-url*="instagr.am/p/"], a[data-expanded-url*="twitpic.com/"], a[data-expanded-url*="yfrog.com/"], a[data-expanded-url*="lockerz.com/"], a[data-expanded-url*="i.imgur.com"]');f=a.map(f,function(b,c){var e=a(b).closest(".tweet").attr("data-tweet-id");if(d.indexOf(e)!=-1){var f=a(b).attr("data-expanded-url");var g=f.replace("http://","").split("/").filter(function(a){return!!a});var h;var i=g.pop();if(typeof i!=="undefined")switch(g.shift()){case"instagr.am":h="https://instagr.am/p/"+i+"/media/?size=t";break;case"twitpic.com":h="https://twitpic.com/show/thumb/"+i;break;case"yfrog.com":h="https://yfrog.com/"+i+":small";break;case"lockerz.com":h="https://api.plixi.com/api/tpapi.svc/imagefromurl?size=small&url=http%3A%2F%2Flockerz.com%2Fs%2F"+i;break;case"i.imgur.com":h="http://i.imgur.com/"+i.replace(".","b.");break;default:h=false;break}if(h)return{id:e,url:h}}});e=e.concat(f);a.each(e,function(b,c){a('[data-tweet-id="'+c.id+'"]').addClass("previeweet").find(".content").append('<div class="previeweetContainer"><img src="'+c.url+'" alt="Photo preview"></div>')})},safeBoot:function(){var a=this;var b=setInterval(function(){if(twttr.app.fullyLoaded()){clearInterval(b);a.init()}},1e3)},init:function(){var a=this;var b=twttr.app.currentPage().getInstanceProperty("streamManager");b.bind("newItemsCountChanged doneLoadingMore",function(){a.main(b)});b.trigger("newItemsCountChanged")}};if(typeof window.using==="function")using(twttr.bundleMore,function(){b.safeBoot()})})(jQuery)
